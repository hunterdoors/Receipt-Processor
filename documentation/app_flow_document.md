# App Flow Document

## Onboarding and Sign-In/Sign-Up

When an administrator first arrives at the web application, they land on a simple landing page that explains the receipt processing system for Knightway Mobile Haulers. From there, they click a link to create their administrator account by entering their email address and choosing a password. The system sends a confirmation email with a link to verify the address. Once the email is confirmed, the administrator can sign in with their credentials. Administrators who forget their password can request a password reset by clicking “Forgot Password” on the sign-in page, entering their registered email, and following the link that is emailed to them to choose a new password. Signing out is as easy as clicking the profile icon in the header and selecting “Sign Out.” Regular employees do not need to access the web dashboard; they submit receipts via SMS or email without logging in at all.

## Main Dashboard or Home Page

After an administrator signs in, they arrive at the main dashboard, which greets them with summary statistics showing the number of pending receipts, approved receipts, and receipts awaiting employee confirmation. The left side features a vertical navigation menu with links to the Receipts list, the Projects list, Audit Logs, and Settings. Across the top is a header bar that includes a search field for quickly finding receipts by vendor, date, or project, along with the administrator’s profile menu. The central area presents widgets for recent activity and a list of receipts that need attention. From this view, administrators can click on any receipt entry to see details, or use the navigation menu to switch to the Projects, Audit Logs, or Settings sections.

## Detailed Feature Flows and Page Transitions

When an employee sends a receipt image or PDF to the dedicated SMS number or email address, the ingestion service captures the message through Twilio for SMS or SendGrid for email. The service validates that each attachment is a JPEG, PNG, or PDF. If the file type is unsupported, it immediately replies to the employee via the same channel, asking them to send a valid image or PDF. Valid files are stored in Supabase Storage and a database record is created to track processing. If the file is a PDF, the system uses an internal PDF conversion library to render each page as a separate image. Each image page then becomes its own receipt record.

Once the images are stored, the processing pipeline calls OpenAI’s Vision API to extract relevant data. The system pulls out the vendor name, purchase order number, total amount, date, currency, tax breakdown, and any invoice fields that may be customized in the future. It also attempts to identify a project identifier. All extracted data is saved in Supabase alongside the original image URLs.

After extraction, the system attempts to match the identified project identifier against the project list that was imported earlier from an Excel 365 workbook via Microsoft Graph. If a match is found, the receipt record is automatically updated with the project details. If no match is found, the system sends an automated message back to the submitting employee, listing the unrecognized project field and prompting them to reply with a valid project nickname. When the employee replies, the ingestion service captures their response, updates the receipt record with the corrected project identifier, and moves the record forward.

Meanwhile, a scheduled job runs every 24 hours to fetch the latest Excel file from the designated Microsoft 365 account. The job downloads the workbook, reads each row for project name, nickname or description, and tax code, and upserts these entries into the Supabase Projects table. This ensures that the receipt processing pipeline always uses current project data without requiring a direct QuickBooks API connection.

Administrators use the web dashboard to review and manage processed receipts. In the Receipts section, they see a table of all records, which they can filter by status, date range, vendor, or project. Clicking on a receipt opens a detail page where the extracted data appears side by side with the original image. From here, an administrator can edit any field, trigger a re-extraction using OpenAI Vision if a correction is needed, override the project assignment, or mark the receipt as approved. When they approve a receipt, the system prepares an expense entry and pushes it to QuickBooks Online through its API, attaching the original image as supporting documentation.

## Settings and Account Management

In the Settings section, accessible only to administrators, users can update their personal profile details, change their password, and configure notification preferences for system alerts. Administrators can also adjust global application settings such as the daily schedule for project list synchronization, retention policies for receipt archiving, and rules for audit log export. From the Settings page, administrators return to the main dashboard by clicking the Dashboard link in the navigation menu or their profile icon in the header.

## Error States and Alternate Paths

If an unsupported file type arrives by SMS or email, the ingestion service immediately responds, asking the employee to resend a JPEG, PNG, or PDF. If the PDF conversion fails, the system retries once and notifies administrators via an alert email if it still cannot process the file. When the OpenAI Vision API returns an error or times out, the pipeline logs the failure and marks the receipt as “Extraction Error,” visible to administrators for manual intervention. In the case of a failed project sync from Excel 365—due to authentication issues or file formatting errors—the system logs the error in the Audit Logs and notifies administrators. Should the QuickBooks Online API reject an expense entry, the receipt remains in a “Posting Error” state, and administrators can view the API response message on the receipt detail page, correct any data, and retry the push.

When employees reply with an invalid project nickname, the ingestion service sends a follow-up message listing available valid nicknames. The system allows two attempts; if the third reply still fails to match, the receipt is flagged for manual review by an administrator.

## Conclusion and Overall App Journey

From their first contact, employees simply send receipts by text message or email and rely on the system to validate, convert, extract, match, and, if necessary, prompt them for missing project information. Administrators onboard easily through a web sign-up, manage their accounts, and sign in to a clear dashboard. Behind the scenes, scheduled jobs keep project data fresh, and the processing pipeline ensures each receipt is transformed into structured data. Administrators then review, correct, and approve receipts before pushing expense entries with attached images into QuickBooks Online. Throughout this journey, every action is recorded in an exportable audit log, and old receipts are archived automatically, delivering a seamless end-to-end experience from submission to accounting integration.